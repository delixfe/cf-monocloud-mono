#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

# fail fast
set -e

BUILD_DIR=$1
CACHE_DIR=$2
BUILDPACK_DIR=`cd $(dirname $0); cd ..; pwd`

# Mono Runtime
echo "* Extract Mono Runtime"
mkdir -p ${BUILD_DIR}/vendor/mono

# curl -s http://www.monobox.ch/mono.tar.gz | tar xz -C ${BUILD_DIR}/vendor/mono/
curl -s http://www.monocloud.ch/downloads/CF/mono.tar.gz | tar xz -C ${BUILD_DIR}/vendor/mono/

#curl -s http://www.monocloud.ch/downloads/CF/mono-4.2.1.60.zip | unzip -d ${BUILD_DIR}/vendor/mono/mono-mono-4.2.1.60

# Start Script
echo "* Copy Startup Script"
cp ${BUILDPACK_DIR}/app/start ${BUILD_DIR}/start
